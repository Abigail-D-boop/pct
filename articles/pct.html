<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Introduction to the pct package • pct</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to the pct package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pct</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/pct.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pct-international.html">Introduction to the Propensity to Cycle Tool (pct) package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="pct_files/htmlwidgets-1.3/htmlwidgets.js"></script><script src="pct_files/jquery-1.12.4/jquery.min.js"></script><link href="pct_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="pct_files/leaflet-1.3.1/leaflet.js"></script><link href="pct_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="pct_files/Proj4Leaflet-1.0.1/proj4-compressed.js"></script><script src="pct_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="pct_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="pct_files/leaflet-binding-2.0.2/leaflet.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>An Introduction to the pct package</h1>
            <h3 class="subtitle">Obtaining and reproducing data from the Propensity to Cycle Tool (PCT)</h3>
                        <h4 class="author">R Lovelace and L Hama</h4>
            
            <h4 class="date">2019-03-24</h4>
      
      
      <div class="hidden name"><code>pct.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The goal of pct is to increase the accessibility and reproducibility of the data produced by the Propensity to Cycle Tool (PCT), a research project and web application hosted at <a href="https://www.pct.bike/">www.pct.bike</a>. For an overview of the data provided by the PCT, clicking on the previous link and trying it out is a great place to start. An academic <a href="https://www.jtlu.org/index.php/jtlu/article/view/862">paper</a> on the PCT provides detail on the motivations for and methods underlying the project.</p>
<p>This introductory vignette demonstrates how the package works with an example from the Isle of Wight, an island on the southern coast of Britain, with a population of ~140,000 people. Before cracking on with a demonstration of package’s functionality, it’s worth providing a little context.</p>
</div>
<div id="why-this-package" class="section level2">
<h2 class="hasAnchor">
<a href="#why-this-package" class="anchor"></a>Why this package?</h2>
<p>The Propensity to Cycle Tool was commissioned by the UK’s Department for Transport to help planners and others prioritise investment and policies to get people cycling, as outlined in the Government report <a href="https://www.gov.uk/government/publications/national-propensity-to-cycle-first-phase-development-study">National propensity to cycle: full report with annexes</a>. However, the academic team leading the project had a wider sub-aim: of making transport evidence more accessible, encouraging evidence-based transport policies, and encouraging a more democratic transport planning process, and that means open transport data and open source transport modelling tools <span class="citation">(Lovelace et al. 2017)</span>.</p>
<p>The code base underlying the PCT is publicly available (see <a href="https://github.com/npct/">github.com/npct</a>). However, the code hosted there is not easy to run or reproduce, which is where this package comes in: it provides quick access to the data underlying the PCT and enables some of the key results to be reproduced quickly. It was developed primarily for educational purposes (including for upcoming PCT training courses) but it may be useful for people to build on the the methods, for example to create a scenario of cycling uptake in their town/city/region.</p>
<p>In summary, if you want to know how PCT works, be able to reproduce some of its results, and build scenarios of cycling uptake to inform transport policies enabling cycling in cities worldwide, this package is for you!</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the development version of the package as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">remotes<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(<span class="st">"ITSLeeds/pct"</span>)</a></code></pre></div>
<!-- You can install the released version of pct from [CRAN](https://CRAN.R-project.org) with: -->
<!-- ``` r -->
<!-- install.packages("pct") -->
<!-- ``` -->
<p>Load the package as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(pct)</a></code></pre></div>
<p>We will also use the following packages in this tutorial:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(sf)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; Linking to GEOS 3.5.0, GDAL 2.1.0, PROJ 4.8.0</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(stplanr)</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(leaflet)</a></code></pre></div>
</div>
<div id="get-pct-data" class="section level1">
<h1 class="hasAnchor">
<a href="#get-pct-data" class="anchor"></a>Get PCT data</h1>
<p>From feedback, we hear that the use of the data is critical in decision making. Therefore, one area where the package could be useful is making the data “easily” available to be processed.</p>
<p>To download the data within www.pct.bike, we have added a suite of functions:</p>
<ul>
<li><code><a href="../reference/get_pct.html">get_pct()</a></code></li>
<li><code><a href="../reference/get_pct_rnet.html">get_pct_rnet()</a></code></li>
<li><code><a href="../reference/get_pct_zones.html">get_pct_zones()</a></code></li>
<li><code><a href="../reference/get_pct_lines.html">get_pct_lines()</a></code></li>
<li><code><a href="../reference/get_pct_centroids.html">get_pct_centroids()</a></code></li>
<li><code><a href="../reference/get_pct_routes_fast.html">get_pct_routes_fast()</a></code></li>
<li><code><a href="../reference/get_pct_routes_quiet.html">get_pct_routes_quiet()</a></code></li>
</ul>
<p>There are other <code>get_()</code> functions that get official data underlying the PCT, as we will see in a later section. For now, let’s see how the functions work. To get the centroids in Isle of Wight, you would run:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(pct)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">wight_centroids =<span class="st"> </span><span class="kw"><a href="../reference/get_pct_centroids.html">get_pct_centroids</a></span>(<span class="dt">region =</span> <span class="st">"isle-of-wight"</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">wight_zones =<span class="st"> </span><span class="kw"><a href="../reference/get_pct_zones.html">get_pct_zones</a></span>(<span class="dt">region =</span> <span class="st">"isle-of-wight"</span>)</a></code></pre></div>
<p>Let’s verify that the data gave us what we would expect to see:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(wight_centroids[, <span class="st">"bicycle"</span>])</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(wight_zones[, <span class="st">"bicycle"</span>])</a></code></pre></div>
<p><img src="pct_files/figure-html/centroids-1.png" width="700"><img src="pct_files/figure-html/centroids-2.png" width="700"></p>
<p>The results are indeed as we would expect, with the centroid data showing points and the zone data showing zones. The zones with higher cycling levels are in the more densly populated south of the island, as we would expect. Likewise, the following command downloads the desire lines for the Isle of Wight:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">wight_lines_pct =<span class="st"> </span><span class="kw"><a href="../reference/get_pct_lines.html">get_pct_lines</a></span>(<span class="dt">region =</span> <span class="st">"isle-of-wight"</span>)</a></code></pre></div>
<p>The rest of the <code>get_pct_</code> functions are similar to the above two examples and download data from www.pct.bike.</p>
<p>However, the base of these functions is <code><a href="../reference/get_pct.html">get_pct()</a></code>, which takes the following arguments:</p>
<ul>
<li>
<code>base_url = "https://github.com/npct/pct-outputs-regional-R/raw/master"</code>: just in case if you wanted to download the data from a similar server</li>
<li>
<code>purpose = "commute"</code>: soon there will be “schools” and maybe other modes, but currently commute is the only option.</li>
<li>
<code>geography = "msoa"</code>: MSOA or LSOA</li>
<li>
<code>region = NULL</code>: regions within <code><a href="../reference/pct_regions.html">pct::pct_regions</a></code>
</li>
<li>
<code>layer = NULL</code>: one of <code>z</code> (zones), <code>c</code> (centroids), <code>l</code> (desire lines), <code>rf</code> (routes fast), <code>rq</code> (routes quiet) or <code>rnet</code>.</li>
<li>even <code>extension = ".Rds"</code> as PCT data is available in various formats. For the purpose of this package we have made the default option of “Rds”.</li>
</ul>
</div>
<div id="comparing-downloaded-data-with-the-pct-web-app" class="section level1">
<h1 class="hasAnchor">
<a href="#comparing-downloaded-data-with-the-pct-web-app" class="anchor"></a>Comparing downloaded data with the PCT web app</h1>
<p>To compare the downloaded data with data in the PCT web app, we will take a subset of the <code>wight_lines_pct</code> dataset. The top 30 travelled desire lines by number of commuters who use cycling as their main mode is taken in the following code chunk. The reason for selecting the top 30 will become apparent (the <code>wight_lines_30</code> object is provided in the PCT package):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">line_order =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/order">order</a></span>(wight_lines_pct<span class="op">$</span>bicycle, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">wight_lines_<span class="dv">30</span> =<span class="st"> </span>wight_lines_pct[line_order[<span class="dv">1</span><span class="op">:</span><span class="dv">30</span>], ]</a></code></pre></div>
<p>The resulting <code>wight_lines_pct</code> and <code>wight_lines_30</code> datasets are available in the package. We’ll use the smaller one for speed. Note: these contain many variables, three of which (the number of people cycling, driving and walking along the desire lines from the 2011 Census) are shown below for the Isle of Wight:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">lwd =<span class="st"> </span>wight_lines_<span class="dv">30</span><span class="op">$</span>all <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(wight_lines_<span class="dv">30</span><span class="op">$</span>all) <span class="op">*</span><span class="st"> </span><span class="dv">5</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(wight_lines_<span class="dv">30</span>[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"bicycle"</span>, <span class="st">"car_driver"</span>, <span class="st">"foot"</span>)], <span class="dt">lwd =</span> lwd)</a></code></pre></div>
<p><img src="pct_files/figure-html/pct-lines-min-1.png" width="700"></p>
<p>To provide another view of the data, focus on cycling, let’s create a leaflet map:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">pal =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/leaflet/topics/colorNumeric">colorNumeric</a></span>(<span class="dt">palette =</span> <span class="st">"RdYlBu"</span>, <span class="dt">domain =</span> wight_lines_<span class="dv">30</span><span class="op">$</span>bicycle)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/leaflet/topics/leaflet">leaflet</a></span>(<span class="dt">data =</span> wight_lines_<span class="dv">30</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/leaflet/topics/map-layers">addTiles</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/leaflet/topics/map-layers">addPolylines</a></span>(<span class="dt">weight =</span> lwd,</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">               <span class="dt">color =</span> <span class="op">~</span><span class="st"> </span><span class="kw">pal</span>(bicycle)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/leaflet/topics/addLegend">addLegend</a></span>(<span class="dt">pal =</span> pal, <span class="dt">values =</span> <span class="op">~</span>bicycle)</a></code></pre></div>
<div id="htmlwidget-6d7c7af64f5eb0220cf6" style="width:100%;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-6d7c7af64f5eb0220cf6">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPolylines","args":[[[[{"lng":[-1.28428479295049,-1.30234477290129],"lat":[50.7032568564458,50.7026730223134]}]],[[{"lng":[-1.28428479295049,-1.30109588996732],"lat":[50.7032568564458,50.694111412435]}]],[[{"lng":[-1.29751408324623,-1.28428479295049],"lat":[50.7571421447456,50.7032568564458]}]],[[{"lng":[-1.29751408324623,-1.28149160450734],"lat":[50.7571421447456,50.751845127431]}]],[[{"lng":[-1.29751408324623,-1.31006711916123],"lat":[50.7571421447456,50.7534038592352]}]],[[{"lng":[-1.31006711916123,-1.28149160450734],"lat":[50.7534038592352,50.751845127431]}]],[[{"lng":[-1.30234477290129,-1.30109588996732],"lat":[50.7026730223134,50.694111412435]}]],[[{"lng":[-1.31006711916123,-1.28428479295049],"lat":[50.7534038592352,50.7032568564458]}]],[[{"lng":[-1.31006711916123,-1.30234477290129],"lat":[50.7534038592352,50.7026730223134]}]],[[{"lng":[-1.28149160450734,-1.28428479295049],"lat":[50.751845127431,50.7032568564458]}]],[[{"lng":[-1.29751408324623,-1.30234477290129],"lat":[50.7571421447456,50.7026730223134]}]],[[{"lng":[-1.28149160450734,-1.30234477290129],"lat":[50.751845127431,50.7026730223134]}]],[[{"lng":[-1.15850885830822,-1.1738784568452],"lat":[50.7287388002202,50.723010861409]}]],[[{"lng":[-1.28428479295049,-1.38653729071091],"lat":[50.7032568564458,50.6816556263349]}]],[[{"lng":[-1.30234477290129,-1.38653729071091],"lat":[50.7026730223134,50.6816556263349]}]],[[{"lng":[-1.28149160450734,-1.30109588996732],"lat":[50.751845127431,50.694111412435]}]],[[{"lng":[-1.15498622859574,-1.18035914920938],"lat":[50.6593991947347,50.6441760538615]}]],[[{"lng":[-1.15850885830822,-1.15588435552669],"lat":[50.7287388002202,50.7218561008228]}]],[[{"lng":[-1.15850885830822,-1.09659838923648],"lat":[50.7287388002202,50.694244497424]}]],[[{"lng":[-1.15588435552669,-1.09659838923648],"lat":[50.7218561008228,50.694244497424]}]],[[{"lng":[-1.18035914920938,-1.17583190156454],"lat":[50.6441760538615,50.634468081491]}]],[[{"lng":[-1.28149160450734,-1.22406933736016],"lat":[50.751845127431,50.726134669078]}]],[[{"lng":[-1.22406933736016,-1.30234477290129],"lat":[50.726134669078,50.7026730223134]}]],[[{"lng":[-1.1738784568452,-1.15588435552669],"lat":[50.723010861409,50.7218561008228]}]],[[{"lng":[-1.30109588996732,-1.18035914920938],"lat":[50.694111412435,50.6441760538615]}]],[[{"lng":[-1.31006711916123,-1.30109588996732],"lat":[50.7534038592352,50.694111412435]}]],[[{"lng":[-1.1738784568452,-1.28428479295049],"lat":[50.723010861409,50.7032568564458]}]],[[{"lng":[-1.15588435552669,-1.28428479295049],"lat":[50.7218561008228,50.7032568564458]}]],[[{"lng":[-1.30234477290129,-1.18035914920938],"lat":[50.7026730223134,50.6441760538615]}]],[[{"lng":[-1.22406933736016,-1.28428479295049],"lat":[50.726134669078,50.7032568564458]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":["#313695","#35409A","#89BEDA","#ACD9E9","#C5E6F0","#C5E6F0","#C5E6F0","#F4FAD6","#FFCF7F","#FEB769","#FCA55D","#F16840","#F16840","#E85637","#E85637","#E44D33","#E44D33","#DF432E","#DA382A","#DA382A","#D52E27","#CD2827","#CD2827","#CD2827","#BD1B27","#B51427","#B51427","#AD0B26","#AD0B26","#A50026"],"weight":[13.5169197807045,9.94391581070011,6.43707858088096,4.82071964206944,7.17436511437394,3.0247652656122,10.652845169828,6.82462663053753,5.03812464553532,5.15155334299578,4.4142668095028,4.23467137185708,5.8510303106686,3.97000441111601,3.83767093074548,2.59940765013548,4.96250551389502,6.72065032453211,3.65807549309975,3.7431470161951,5.57691095847249,1.6352637217216,2.84516982796648,3.28943222635327,2.40090742957968,2.56159808431533,3.62971831873464,4.05507593421135,2.80736026214632,4.62221942151364],"opacity":0.5,"fill":false,"fillColor":["#313695","#35409A","#89BEDA","#ACD9E9","#C5E6F0","#C5E6F0","#C5E6F0","#F4FAD6","#FFCF7F","#FEB769","#FCA55D","#F16840","#F16840","#E85637","#E85637","#E44D33","#E44D33","#DF432E","#DA382A","#DA382A","#D52E27","#CD2827","#CD2827","#CD2827","#BD1B27","#B51427","#B51427","#AD0B26","#AD0B26","#A50026"],"fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLegend","args":[{"colors":["#A50026 , #AD0B26 1.58730158730159%, #ED5F3C 17.4603174603175%, #FEBF70 33.3333333333333%, #FFFDBB 49.2063492063492%, #C5E6F0 65.0793650793651%, #70A7CE 80.9523809523809%, #394A9F 96.8253968253968%, #313695 "],"labels":["10","20","30","40","50","60","70"],"na_color":null,"na_label":"NA","opacity":0.5,"position":"topright","type":"numeric","title":"bicycle","extra":{"p_1":0.0158730158730159,"p_n":0.968253968253968},"layerId":null,"className":"info legend","group":null}]}],"limits":{"lat":[50.634468081491,50.7571421447456],"lng":[-1.38653729071091,-1.09659838923648]}},"evals":[],"jsHooks":[]}</script><p>There was a reason for selecting the top 30 lines: it mirrors the view of the desire lines available from the PCT web application for the island, available at <a href="http://www.pct.bike/m/?r=isle-of-wight">www.pct.bike/m/?r=isle-of-wight</a> (note that Straight Lines is selected from the Cycling Flows dropdown menu in the image below, and by default shows the top 30 flows by number of bicycle trips).</p>
<p><img src="https://user-images.githubusercontent.com/1825120/54882128-c4f02980-4e4e-11e9-8eb8-49c43507165a.png" width="100%"></p>
<div id="getting-census-data" class="section level2">
<h2 class="hasAnchor">
<a href="#getting-census-data" class="anchor"></a>Getting Census data</h2>
<p>The previous section showed that data downloaded with <code>get_pct*()</code> functions <em>get</em> the results generated by the PCT. However, they do not <em>reproduce</em> the results generated by the PCT, starting from first priciples and publicly available, official data. Underlying the PCT is origin-destination data from the 2011 Census. The MSOA-level data is open access, so we only provide access to this dataset. The following command gets the origin-destination data for the Isle of Wight:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">wight_od_all =<span class="st"> </span><span class="kw"><a href="../reference/get_od.html">get_od</a></span>(<span class="dt">area =</span> <span class="st">"wight"</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(wight_od_all<span class="op">$</span>geo_code1 <span class="op">%in%</span><span class="st"> </span>wight_centroids<span class="op">$</span>geo_code)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt;    Mode    TRUE </span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt; logical    2851</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(wight_od_all<span class="op">$</span>geo_code2 <span class="op">%in%</span><span class="st"> </span>wight_centroids<span class="op">$</span>geo_code)</a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt;    Mode   FALSE    TRUE </span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; logical    2527     324</span></a></code></pre></div>
<p>Note that all the origin codes match the Isle of Wight centroid codes, but most of the destination zones do not. This is because many people on the island work outside the island. <code><a href="../reference/get_od.html">get_od()</a></code> by default returns only OD pairs in which the commute trips originate from the <code>area</code> entered.</p>
<p>To make the dataset smaller and simpler, let’s subset it so it only contains OD pairs in which the origin <em>and</em> destination are in the island (the resulting <code>wight_od</code> data is provided in the package):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">wight_od =<span class="st"> </span>wight_od_all[</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  wight_od_all<span class="op">$</span>geo_code2 <span class="op">%in%</span><span class="st"> </span>wight_centroids<span class="op">$</span>geo_code,]</a></code></pre></div>
<p>To convert the results to geographic desire lines, we can use the function <code><a href="https://ropensci.github.io/stplanr/reference/od2line.html">od2line()</a></code> from the <code>stplanr</code> package:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">wight_lines_census =<span class="st"> </span><span class="kw"><a href="https://ropensci.github.io/stplanr/reference/od2line.html">od2line</a></span>(wight_od, wight_centroids)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(wight_lines_census)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt; [1] 324</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(wight_lines_census<span class="op">$</span>all)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; [1] 42139</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co"># view 10 lines</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/leaflet/topics/leaflet">leaflet</a></span>(<span class="dt">width =</span> <span class="st">"100%"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/leaflet/topics/map-layers">addTiles</a></span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/leaflet/topics/map-layers">addPolylines</a></span>(<span class="dt">data =</span> wight_lines_census)</a></code></pre></div>
<div id="htmlwidget-411058538fb60fc008f8" style="width:100%;height:432.632880098888px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-411058538fb60fc008f8">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"http://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"http://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addPolylines","args":[[[[{"lng":[-1.29751408324623,-1.29751408324623],"lat":[50.7571421447456,50.7571421447456]}]],[[{"lng":[-1.29751408324623,-1.31006711916123],"lat":[50.7571421447456,50.7534038592352]}]],[[{"lng":[-1.29751408324623,-1.28149160450734],"lat":[50.7571421447456,50.751845127431]}]],[[{"lng":[-1.29751408324623,-1.15850885830822],"lat":[50.7571421447456,50.7287388002202]}]],[[{"lng":[-1.29751408324623,-1.22406933736016],"lat":[50.7571421447456,50.726134669078]}]],[[{"lng":[-1.29751408324623,-1.1738784568452],"lat":[50.7571421447456,50.723010861409]}]],[[{"lng":[-1.29751408324623,-1.15588435552669],"lat":[50.7571421447456,50.7218561008228]}]],[[{"lng":[-1.29751408324623,-1.28428479295049],"lat":[50.7571421447456,50.7032568564458]}]],[[{"lng":[-1.29751408324623,-1.3023447729013],"lat":[50.7571421447456,50.7026730223134]}]],[[{"lng":[-1.29751408324623,-1.09659838923648],"lat":[50.7571421447456,50.694244497424]}]],[[{"lng":[-1.29751408324623,-1.30109588996732],"lat":[50.7571421447456,50.694111412435]}]],[[{"lng":[-1.29751408324623,-1.52635769238148],"lat":[50.7571421447456,50.6839661914116]}]],[[{"lng":[-1.29751408324623,-1.38653729071091],"lat":[50.7571421447456,50.6816556263349]}]],[[{"lng":[-1.29751408324623,-1.15498622859574],"lat":[50.7571421447456,50.6593991947347]}]],[[{"lng":[-1.29751408324623,-1.18035914920938],"lat":[50.7571421447456,50.6441760538615]}]],[[{"lng":[-1.29751408324623,-1.17583190156454],"lat":[50.7571421447456,50.634468081491]}]],[[{"lng":[-1.29751408324623,-1.28375913686034],"lat":[50.7571421447456,50.6156869113117]}]],[[{"lng":[-1.29751408324623,-1.21080959854917],"lat":[50.7571421447456,50.5978105158296]}]],[[{"lng":[-1.31006711916123,-1.29751408324623],"lat":[50.7534038592352,50.7571421447456]}]],[[{"lng":[-1.31006711916123,-1.31006711916123],"lat":[50.7534038592352,50.7534038592352]}]],[[{"lng":[-1.31006711916123,-1.28149160450734],"lat":[50.7534038592352,50.751845127431]}]],[[{"lng":[-1.31006711916123,-1.15850885830822],"lat":[50.7534038592352,50.7287388002202]}]],[[{"lng":[-1.31006711916123,-1.22406933736016],"lat":[50.7534038592352,50.726134669078]}]],[[{"lng":[-1.31006711916123,-1.1738784568452],"lat":[50.7534038592352,50.723010861409]}]],[[{"lng":[-1.31006711916123,-1.15588435552669],"lat":[50.7534038592352,50.7218561008228]}]],[[{"lng":[-1.31006711916123,-1.28428479295049],"lat":[50.7534038592352,50.7032568564458]}]],[[{"lng":[-1.31006711916123,-1.3023447729013],"lat":[50.7534038592352,50.7026730223134]}]],[[{"lng":[-1.31006711916123,-1.09659838923648],"lat":[50.7534038592352,50.694244497424]}]],[[{"lng":[-1.31006711916123,-1.30109588996732],"lat":[50.7534038592352,50.694111412435]}]],[[{"lng":[-1.31006711916123,-1.52635769238148],"lat":[50.7534038592352,50.6839661914116]}]],[[{"lng":[-1.31006711916123,-1.38653729071091],"lat":[50.7534038592352,50.6816556263349]}]],[[{"lng":[-1.31006711916123,-1.15498622859574],"lat":[50.7534038592352,50.6593991947347]}]],[[{"lng":[-1.31006711916123,-1.18035914920938],"lat":[50.7534038592352,50.6441760538615]}]],[[{"lng":[-1.31006711916123,-1.17583190156454],"lat":[50.7534038592352,50.634468081491]}]],[[{"lng":[-1.31006711916123,-1.28375913686034],"lat":[50.7534038592352,50.6156869113117]}]],[[{"lng":[-1.31006711916123,-1.21080959854917],"lat":[50.7534038592352,50.5978105158296]}]],[[{"lng":[-1.28149160450734,-1.29751408324623],"lat":[50.751845127431,50.7571421447456]}]],[[{"lng":[-1.28149160450734,-1.31006711916123],"lat":[50.751845127431,50.7534038592352]}]],[[{"lng":[-1.28149160450734,-1.28149160450734],"lat":[50.751845127431,50.751845127431]}]],[[{"lng":[-1.28149160450734,-1.15850885830822],"lat":[50.751845127431,50.7287388002202]}]],[[{"lng":[-1.28149160450734,-1.22406933736016],"lat":[50.751845127431,50.726134669078]}]],[[{"lng":[-1.28149160450734,-1.1738784568452],"lat":[50.751845127431,50.723010861409]}]],[[{"lng":[-1.28149160450734,-1.15588435552669],"lat":[50.751845127431,50.7218561008228]}]],[[{"lng":[-1.28149160450734,-1.28428479295049],"lat":[50.751845127431,50.7032568564458]}]],[[{"lng":[-1.28149160450734,-1.3023447729013],"lat":[50.751845127431,50.7026730223134]}]],[[{"lng":[-1.28149160450734,-1.09659838923648],"lat":[50.751845127431,50.694244497424]}]],[[{"lng":[-1.28149160450734,-1.30109588996732],"lat":[50.751845127431,50.694111412435]}]],[[{"lng":[-1.28149160450734,-1.52635769238148],"lat":[50.751845127431,50.6839661914116]}]],[[{"lng":[-1.28149160450734,-1.38653729071091],"lat":[50.751845127431,50.6816556263349]}]],[[{"lng":[-1.28149160450734,-1.15498622859574],"lat":[50.751845127431,50.6593991947347]}]],[[{"lng":[-1.28149160450734,-1.18035914920938],"lat":[50.751845127431,50.6441760538615]}]],[[{"lng":[-1.28149160450734,-1.17583190156454],"lat":[50.751845127431,50.634468081491]}]],[[{"lng":[-1.28149160450734,-1.28375913686034],"lat":[50.751845127431,50.6156869113117]}]],[[{"lng":[-1.28149160450734,-1.21080959854917],"lat":[50.751845127431,50.5978105158296]}]],[[{"lng":[-1.15850885830822,-1.29751408324623],"lat":[50.7287388002202,50.7571421447456]}]],[[{"lng":[-1.15850885830822,-1.31006711916123],"lat":[50.7287388002202,50.7534038592352]}]],[[{"lng":[-1.15850885830822,-1.28149160450734],"lat":[50.7287388002202,50.751845127431]}]],[[{"lng":[-1.15850885830822,-1.15850885830822],"lat":[50.7287388002202,50.7287388002202]}]],[[{"lng":[-1.15850885830822,-1.22406933736016],"lat":[50.7287388002202,50.726134669078]}]],[[{"lng":[-1.15850885830822,-1.1738784568452],"lat":[50.7287388002202,50.723010861409]}]],[[{"lng":[-1.15850885830822,-1.15588435552669],"lat":[50.7287388002202,50.7218561008228]}]],[[{"lng":[-1.15850885830822,-1.28428479295049],"lat":[50.7287388002202,50.7032568564458]}]],[[{"lng":[-1.15850885830822,-1.3023447729013],"lat":[50.7287388002202,50.7026730223134]}]],[[{"lng":[-1.15850885830822,-1.09659838923648],"lat":[50.7287388002202,50.694244497424]}]],[[{"lng":[-1.15850885830822,-1.30109588996732],"lat":[50.7287388002202,50.694111412435]}]],[[{"lng":[-1.15850885830822,-1.52635769238148],"lat":[50.7287388002202,50.6839661914116]}]],[[{"lng":[-1.15850885830822,-1.38653729071091],"lat":[50.7287388002202,50.6816556263349]}]],[[{"lng":[-1.15850885830822,-1.15498622859574],"lat":[50.7287388002202,50.6593991947347]}]],[[{"lng":[-1.15850885830822,-1.18035914920938],"lat":[50.7287388002202,50.6441760538615]}]],[[{"lng":[-1.15850885830822,-1.17583190156454],"lat":[50.7287388002202,50.634468081491]}]],[[{"lng":[-1.15850885830822,-1.28375913686034],"lat":[50.7287388002202,50.6156869113117]}]],[[{"lng":[-1.15850885830822,-1.21080959854917],"lat":[50.7287388002202,50.5978105158296]}]],[[{"lng":[-1.22406933736016,-1.29751408324623],"lat":[50.726134669078,50.7571421447456]}]],[[{"lng":[-1.22406933736016,-1.31006711916123],"lat":[50.726134669078,50.7534038592352]}]],[[{"lng":[-1.22406933736016,-1.28149160450734],"lat":[50.726134669078,50.751845127431]}]],[[{"lng":[-1.22406933736016,-1.15850885830822],"lat":[50.726134669078,50.7287388002202]}]],[[{"lng":[-1.22406933736016,-1.22406933736016],"lat":[50.726134669078,50.726134669078]}]],[[{"lng":[-1.22406933736016,-1.1738784568452],"lat":[50.726134669078,50.723010861409]}]],[[{"lng":[-1.22406933736016,-1.15588435552669],"lat":[50.726134669078,50.7218561008228]}]],[[{"lng":[-1.22406933736016,-1.28428479295049],"lat":[50.726134669078,50.7032568564458]}]],[[{"lng":[-1.22406933736016,-1.3023447729013],"lat":[50.726134669078,50.7026730223134]}]],[[{"lng":[-1.22406933736016,-1.09659838923648],"lat":[50.726134669078,50.694244497424]}]],[[{"lng":[-1.22406933736016,-1.30109588996732],"lat":[50.726134669078,50.694111412435]}]],[[{"lng":[-1.22406933736016,-1.52635769238148],"lat":[50.726134669078,50.6839661914116]}]],[[{"lng":[-1.22406933736016,-1.38653729071091],"lat":[50.726134669078,50.6816556263349]}]],[[{"lng":[-1.22406933736016,-1.15498622859574],"lat":[50.726134669078,50.6593991947347]}]],[[{"lng":[-1.22406933736016,-1.18035914920938],"lat":[50.726134669078,50.6441760538615]}]],[[{"lng":[-1.22406933736016,-1.17583190156454],"lat":[50.726134669078,50.634468081491]}]],[[{"lng":[-1.22406933736016,-1.28375913686034],"lat":[50.726134669078,50.6156869113117]}]],[[{"lng":[-1.22406933736016,-1.21080959854917],"lat":[50.726134669078,50.5978105158296]}]],[[{"lng":[-1.1738784568452,-1.29751408324623],"lat":[50.723010861409,50.7571421447456]}]],[[{"lng":[-1.1738784568452,-1.31006711916123],"lat":[50.723010861409,50.7534038592352]}]],[[{"lng":[-1.1738784568452,-1.28149160450734],"lat":[50.723010861409,50.751845127431]}]],[[{"lng":[-1.1738784568452,-1.15850885830822],"lat":[50.723010861409,50.7287388002202]}]],[[{"lng":[-1.1738784568452,-1.22406933736016],"lat":[50.723010861409,50.726134669078]}]],[[{"lng":[-1.1738784568452,-1.1738784568452],"lat":[50.723010861409,50.723010861409]}]],[[{"lng":[-1.1738784568452,-1.15588435552669],"lat":[50.723010861409,50.7218561008228]}]],[[{"lng":[-1.1738784568452,-1.28428479295049],"lat":[50.723010861409,50.7032568564458]}]],[[{"lng":[-1.1738784568452,-1.3023447729013],"lat":[50.723010861409,50.7026730223134]}]],[[{"lng":[-1.1738784568452,-1.09659838923648],"lat":[50.723010861409,50.694244497424]}]],[[{"lng":[-1.1738784568452,-1.30109588996732],"lat":[50.723010861409,50.694111412435]}]],[[{"lng":[-1.1738784568452,-1.52635769238148],"lat":[50.723010861409,50.6839661914116]}]],[[{"lng":[-1.1738784568452,-1.38653729071091],"lat":[50.723010861409,50.6816556263349]}]],[[{"lng":[-1.1738784568452,-1.15498622859574],"lat":[50.723010861409,50.6593991947347]}]],[[{"lng":[-1.1738784568452,-1.18035914920938],"lat":[50.723010861409,50.6441760538615]}]],[[{"lng":[-1.1738784568452,-1.17583190156454],"lat":[50.723010861409,50.634468081491]}]],[[{"lng":[-1.1738784568452,-1.28375913686034],"lat":[50.723010861409,50.6156869113117]}]],[[{"lng":[-1.1738784568452,-1.21080959854917],"lat":[50.723010861409,50.5978105158296]}]],[[{"lng":[-1.15588435552669,-1.29751408324623],"lat":[50.7218561008228,50.7571421447456]}]],[[{"lng":[-1.15588435552669,-1.31006711916123],"lat":[50.7218561008228,50.7534038592352]}]],[[{"lng":[-1.15588435552669,-1.28149160450734],"lat":[50.7218561008228,50.751845127431]}]],[[{"lng":[-1.15588435552669,-1.15850885830822],"lat":[50.7218561008228,50.7287388002202]}]],[[{"lng":[-1.15588435552669,-1.22406933736016],"lat":[50.7218561008228,50.726134669078]}]],[[{"lng":[-1.15588435552669,-1.1738784568452],"lat":[50.7218561008228,50.723010861409]}]],[[{"lng":[-1.15588435552669,-1.15588435552669],"lat":[50.7218561008228,50.7218561008228]}]],[[{"lng":[-1.15588435552669,-1.28428479295049],"lat":[50.7218561008228,50.7032568564458]}]],[[{"lng":[-1.15588435552669,-1.3023447729013],"lat":[50.7218561008228,50.7026730223134]}]],[[{"lng":[-1.15588435552669,-1.09659838923648],"lat":[50.7218561008228,50.694244497424]}]],[[{"lng":[-1.15588435552669,-1.30109588996732],"lat":[50.7218561008228,50.694111412435]}]],[[{"lng":[-1.15588435552669,-1.52635769238148],"lat":[50.7218561008228,50.6839661914116]}]],[[{"lng":[-1.15588435552669,-1.38653729071091],"lat":[50.7218561008228,50.6816556263349]}]],[[{"lng":[-1.15588435552669,-1.15498622859574],"lat":[50.7218561008228,50.6593991947347]}]],[[{"lng":[-1.15588435552669,-1.18035914920938],"lat":[50.7218561008228,50.6441760538615]}]],[[{"lng":[-1.15588435552669,-1.17583190156454],"lat":[50.7218561008228,50.634468081491]}]],[[{"lng":[-1.15588435552669,-1.28375913686034],"lat":[50.7218561008228,50.6156869113117]}]],[[{"lng":[-1.15588435552669,-1.21080959854917],"lat":[50.7218561008228,50.5978105158296]}]],[[{"lng":[-1.28428479295049,-1.29751408324623],"lat":[50.7032568564458,50.7571421447456]}]],[[{"lng":[-1.28428479295049,-1.31006711916123],"lat":[50.7032568564458,50.7534038592352]}]],[[{"lng":[-1.28428479295049,-1.28149160450734],"lat":[50.7032568564458,50.751845127431]}]],[[{"lng":[-1.28428479295049,-1.15850885830822],"lat":[50.7032568564458,50.7287388002202]}]],[[{"lng":[-1.28428479295049,-1.22406933736016],"lat":[50.7032568564458,50.726134669078]}]],[[{"lng":[-1.28428479295049,-1.1738784568452],"lat":[50.7032568564458,50.723010861409]}]],[[{"lng":[-1.28428479295049,-1.15588435552669],"lat":[50.7032568564458,50.7218561008228]}]],[[{"lng":[-1.28428479295049,-1.28428479295049],"lat":[50.7032568564458,50.7032568564458]}]],[[{"lng":[-1.28428479295049,-1.3023447729013],"lat":[50.7032568564458,50.7026730223134]}]],[[{"lng":[-1.28428479295049,-1.09659838923648],"lat":[50.7032568564458,50.694244497424]}]],[[{"lng":[-1.28428479295049,-1.30109588996732],"lat":[50.7032568564458,50.694111412435]}]],[[{"lng":[-1.28428479295049,-1.52635769238148],"lat":[50.7032568564458,50.6839661914116]}]],[[{"lng":[-1.28428479295049,-1.38653729071091],"lat":[50.7032568564458,50.6816556263349]}]],[[{"lng":[-1.28428479295049,-1.15498622859574],"lat":[50.7032568564458,50.6593991947347]}]],[[{"lng":[-1.28428479295049,-1.18035914920938],"lat":[50.7032568564458,50.6441760538615]}]],[[{"lng":[-1.28428479295049,-1.17583190156454],"lat":[50.7032568564458,50.634468081491]}]],[[{"lng":[-1.28428479295049,-1.28375913686034],"lat":[50.7032568564458,50.6156869113117]}]],[[{"lng":[-1.28428479295049,-1.21080959854917],"lat":[50.7032568564458,50.5978105158296]}]],[[{"lng":[-1.3023447729013,-1.29751408324623],"lat":[50.7026730223134,50.7571421447456]}]],[[{"lng":[-1.3023447729013,-1.31006711916123],"lat":[50.7026730223134,50.7534038592352]}]],[[{"lng":[-1.3023447729013,-1.28149160450734],"lat":[50.7026730223134,50.751845127431]}]],[[{"lng":[-1.3023447729013,-1.15850885830822],"lat":[50.7026730223134,50.7287388002202]}]],[[{"lng":[-1.3023447729013,-1.22406933736016],"lat":[50.7026730223134,50.726134669078]}]],[[{"lng":[-1.3023447729013,-1.1738784568452],"lat":[50.7026730223134,50.723010861409]}]],[[{"lng":[-1.3023447729013,-1.15588435552669],"lat":[50.7026730223134,50.7218561008228]}]],[[{"lng":[-1.3023447729013,-1.28428479295049],"lat":[50.7026730223134,50.7032568564458]}]],[[{"lng":[-1.3023447729013,-1.3023447729013],"lat":[50.7026730223134,50.7026730223134]}]],[[{"lng":[-1.3023447729013,-1.09659838923648],"lat":[50.7026730223134,50.694244497424]}]],[[{"lng":[-1.3023447729013,-1.30109588996732],"lat":[50.7026730223134,50.694111412435]}]],[[{"lng":[-1.3023447729013,-1.52635769238148],"lat":[50.7026730223134,50.6839661914116]}]],[[{"lng":[-1.3023447729013,-1.38653729071091],"lat":[50.7026730223134,50.6816556263349]}]],[[{"lng":[-1.3023447729013,-1.15498622859574],"lat":[50.7026730223134,50.6593991947347]}]],[[{"lng":[-1.3023447729013,-1.18035914920938],"lat":[50.7026730223134,50.6441760538615]}]],[[{"lng":[-1.3023447729013,-1.17583190156454],"lat":[50.7026730223134,50.634468081491]}]],[[{"lng":[-1.3023447729013,-1.28375913686034],"lat":[50.7026730223134,50.6156869113117]}]],[[{"lng":[-1.3023447729013,-1.21080959854917],"lat":[50.7026730223134,50.5978105158296]}]],[[{"lng":[-1.09659838923648,-1.29751408324623],"lat":[50.694244497424,50.7571421447456]}]],[[{"lng":[-1.09659838923648,-1.31006711916123],"lat":[50.694244497424,50.7534038592352]}]],[[{"lng":[-1.09659838923648,-1.28149160450734],"lat":[50.694244497424,50.751845127431]}]],[[{"lng":[-1.09659838923648,-1.15850885830822],"lat":[50.694244497424,50.7287388002202]}]],[[{"lng":[-1.09659838923648,-1.22406933736016],"lat":[50.694244497424,50.726134669078]}]],[[{"lng":[-1.09659838923648,-1.1738784568452],"lat":[50.694244497424,50.723010861409]}]],[[{"lng":[-1.09659838923648,-1.15588435552669],"lat":[50.694244497424,50.7218561008228]}]],[[{"lng":[-1.09659838923648,-1.28428479295049],"lat":[50.694244497424,50.7032568564458]}]],[[{"lng":[-1.09659838923648,-1.3023447729013],"lat":[50.694244497424,50.7026730223134]}]],[[{"lng":[-1.09659838923648,-1.09659838923648],"lat":[50.694244497424,50.694244497424]}]],[[{"lng":[-1.09659838923648,-1.30109588996732],"lat":[50.694244497424,50.694111412435]}]],[[{"lng":[-1.09659838923648,-1.52635769238148],"lat":[50.694244497424,50.6839661914116]}]],[[{"lng":[-1.09659838923648,-1.38653729071091],"lat":[50.694244497424,50.6816556263349]}]],[[{"lng":[-1.09659838923648,-1.15498622859574],"lat":[50.694244497424,50.6593991947347]}]],[[{"lng":[-1.09659838923648,-1.18035914920938],"lat":[50.694244497424,50.6441760538615]}]],[[{"lng":[-1.09659838923648,-1.17583190156454],"lat":[50.694244497424,50.634468081491]}]],[[{"lng":[-1.09659838923648,-1.28375913686034],"lat":[50.694244497424,50.6156869113117]}]],[[{"lng":[-1.09659838923648,-1.21080959854917],"lat":[50.694244497424,50.5978105158296]}]],[[{"lng":[-1.30109588996732,-1.29751408324623],"lat":[50.694111412435,50.7571421447456]}]],[[{"lng":[-1.30109588996732,-1.31006711916123],"lat":[50.694111412435,50.7534038592352]}]],[[{"lng":[-1.30109588996732,-1.28149160450734],"lat":[50.694111412435,50.751845127431]}]],[[{"lng":[-1.30109588996732,-1.15850885830822],"lat":[50.694111412435,50.7287388002202]}]],[[{"lng":[-1.30109588996732,-1.22406933736016],"lat":[50.694111412435,50.726134669078]}]],[[{"lng":[-1.30109588996732,-1.1738784568452],"lat":[50.694111412435,50.723010861409]}]],[[{"lng":[-1.30109588996732,-1.15588435552669],"lat":[50.694111412435,50.7218561008228]}]],[[{"lng":[-1.30109588996732,-1.28428479295049],"lat":[50.694111412435,50.7032568564458]}]],[[{"lng":[-1.30109588996732,-1.3023447729013],"lat":[50.694111412435,50.7026730223134]}]],[[{"lng":[-1.30109588996732,-1.09659838923648],"lat":[50.694111412435,50.694244497424]}]],[[{"lng":[-1.30109588996732,-1.30109588996732],"lat":[50.694111412435,50.694111412435]}]],[[{"lng":[-1.30109588996732,-1.52635769238148],"lat":[50.694111412435,50.6839661914116]}]],[[{"lng":[-1.30109588996732,-1.38653729071091],"lat":[50.694111412435,50.6816556263349]}]],[[{"lng":[-1.30109588996732,-1.15498622859574],"lat":[50.694111412435,50.6593991947347]}]],[[{"lng":[-1.30109588996732,-1.18035914920938],"lat":[50.694111412435,50.6441760538615]}]],[[{"lng":[-1.30109588996732,-1.17583190156454],"lat":[50.694111412435,50.634468081491]}]],[[{"lng":[-1.30109588996732,-1.28375913686034],"lat":[50.694111412435,50.6156869113117]}]],[[{"lng":[-1.30109588996732,-1.21080959854917],"lat":[50.694111412435,50.5978105158296]}]],[[{"lng":[-1.52635769238148,-1.29751408324623],"lat":[50.6839661914116,50.7571421447456]}]],[[{"lng":[-1.52635769238148,-1.31006711916123],"lat":[50.6839661914116,50.7534038592352]}]],[[{"lng":[-1.52635769238148,-1.28149160450734],"lat":[50.6839661914116,50.751845127431]}]],[[{"lng":[-1.52635769238148,-1.15850885830822],"lat":[50.6839661914116,50.7287388002202]}]],[[{"lng":[-1.52635769238148,-1.22406933736016],"lat":[50.6839661914116,50.726134669078]}]],[[{"lng":[-1.52635769238148,-1.1738784568452],"lat":[50.6839661914116,50.723010861409]}]],[[{"lng":[-1.52635769238148,-1.15588435552669],"lat":[50.6839661914116,50.7218561008228]}]],[[{"lng":[-1.52635769238148,-1.28428479295049],"lat":[50.6839661914116,50.7032568564458]}]],[[{"lng":[-1.52635769238148,-1.3023447729013],"lat":[50.6839661914116,50.7026730223134]}]],[[{"lng":[-1.52635769238148,-1.09659838923648],"lat":[50.6839661914116,50.694244497424]}]],[[{"lng":[-1.52635769238148,-1.30109588996732],"lat":[50.6839661914116,50.694111412435]}]],[[{"lng":[-1.52635769238148,-1.52635769238148],"lat":[50.6839661914116,50.6839661914116]}]],[[{"lng":[-1.52635769238148,-1.38653729071091],"lat":[50.6839661914116,50.6816556263349]}]],[[{"lng":[-1.52635769238148,-1.15498622859574],"lat":[50.6839661914116,50.6593991947347]}]],[[{"lng":[-1.52635769238148,-1.18035914920938],"lat":[50.6839661914116,50.6441760538615]}]],[[{"lng":[-1.52635769238148,-1.17583190156454],"lat":[50.6839661914116,50.634468081491]}]],[[{"lng":[-1.52635769238148,-1.28375913686034],"lat":[50.6839661914116,50.6156869113117]}]],[[{"lng":[-1.52635769238148,-1.21080959854917],"lat":[50.6839661914116,50.5978105158296]}]],[[{"lng":[-1.38653729071091,-1.29751408324623],"lat":[50.6816556263349,50.7571421447456]}]],[[{"lng":[-1.38653729071091,-1.31006711916123],"lat":[50.6816556263349,50.7534038592352]}]],[[{"lng":[-1.38653729071091,-1.28149160450734],"lat":[50.6816556263349,50.751845127431]}]],[[{"lng":[-1.38653729071091,-1.15850885830822],"lat":[50.6816556263349,50.7287388002202]}]],[[{"lng":[-1.38653729071091,-1.22406933736016],"lat":[50.6816556263349,50.726134669078]}]],[[{"lng":[-1.38653729071091,-1.1738784568452],"lat":[50.6816556263349,50.723010861409]}]],[[{"lng":[-1.38653729071091,-1.15588435552669],"lat":[50.6816556263349,50.7218561008228]}]],[[{"lng":[-1.38653729071091,-1.28428479295049],"lat":[50.6816556263349,50.7032568564458]}]],[[{"lng":[-1.38653729071091,-1.3023447729013],"lat":[50.6816556263349,50.7026730223134]}]],[[{"lng":[-1.38653729071091,-1.09659838923648],"lat":[50.6816556263349,50.694244497424]}]],[[{"lng":[-1.38653729071091,-1.30109588996732],"lat":[50.6816556263349,50.694111412435]}]],[[{"lng":[-1.38653729071091,-1.52635769238148],"lat":[50.6816556263349,50.6839661914116]}]],[[{"lng":[-1.38653729071091,-1.38653729071091],"lat":[50.6816556263349,50.6816556263349]}]],[[{"lng":[-1.38653729071091,-1.15498622859574],"lat":[50.6816556263349,50.6593991947347]}]],[[{"lng":[-1.38653729071091,-1.18035914920938],"lat":[50.6816556263349,50.6441760538615]}]],[[{"lng":[-1.38653729071091,-1.17583190156454],"lat":[50.6816556263349,50.634468081491]}]],[[{"lng":[-1.38653729071091,-1.28375913686034],"lat":[50.6816556263349,50.6156869113117]}]],[[{"lng":[-1.38653729071091,-1.21080959854917],"lat":[50.6816556263349,50.5978105158296]}]],[[{"lng":[-1.15498622859574,-1.29751408324623],"lat":[50.6593991947347,50.7571421447456]}]],[[{"lng":[-1.15498622859574,-1.31006711916123],"lat":[50.6593991947347,50.7534038592352]}]],[[{"lng":[-1.15498622859574,-1.28149160450734],"lat":[50.6593991947347,50.751845127431]}]],[[{"lng":[-1.15498622859574,-1.15850885830822],"lat":[50.6593991947347,50.7287388002202]}]],[[{"lng":[-1.15498622859574,-1.22406933736016],"lat":[50.6593991947347,50.726134669078]}]],[[{"lng":[-1.15498622859574,-1.1738784568452],"lat":[50.6593991947347,50.723010861409]}]],[[{"lng":[-1.15498622859574,-1.15588435552669],"lat":[50.6593991947347,50.7218561008228]}]],[[{"lng":[-1.15498622859574,-1.28428479295049],"lat":[50.6593991947347,50.7032568564458]}]],[[{"lng":[-1.15498622859574,-1.3023447729013],"lat":[50.6593991947347,50.7026730223134]}]],[[{"lng":[-1.15498622859574,-1.09659838923648],"lat":[50.6593991947347,50.694244497424]}]],[[{"lng":[-1.15498622859574,-1.30109588996732],"lat":[50.6593991947347,50.694111412435]}]],[[{"lng":[-1.15498622859574,-1.52635769238148],"lat":[50.6593991947347,50.6839661914116]}]],[[{"lng":[-1.15498622859574,-1.38653729071091],"lat":[50.6593991947347,50.6816556263349]}]],[[{"lng":[-1.15498622859574,-1.15498622859574],"lat":[50.6593991947347,50.6593991947347]}]],[[{"lng":[-1.15498622859574,-1.18035914920938],"lat":[50.6593991947347,50.6441760538615]}]],[[{"lng":[-1.15498622859574,-1.17583190156454],"lat":[50.6593991947347,50.634468081491]}]],[[{"lng":[-1.15498622859574,-1.28375913686034],"lat":[50.6593991947347,50.6156869113117]}]],[[{"lng":[-1.15498622859574,-1.21080959854917],"lat":[50.6593991947347,50.5978105158296]}]],[[{"lng":[-1.18035914920938,-1.29751408324623],"lat":[50.6441760538615,50.7571421447456]}]],[[{"lng":[-1.18035914920938,-1.31006711916123],"lat":[50.6441760538615,50.7534038592352]}]],[[{"lng":[-1.18035914920938,-1.28149160450734],"lat":[50.6441760538615,50.751845127431]}]],[[{"lng":[-1.18035914920938,-1.15850885830822],"lat":[50.6441760538615,50.7287388002202]}]],[[{"lng":[-1.18035914920938,-1.22406933736016],"lat":[50.6441760538615,50.726134669078]}]],[[{"lng":[-1.18035914920938,-1.1738784568452],"lat":[50.6441760538615,50.723010861409]}]],[[{"lng":[-1.18035914920938,-1.15588435552669],"lat":[50.6441760538615,50.7218561008228]}]],[[{"lng":[-1.18035914920938,-1.28428479295049],"lat":[50.6441760538615,50.7032568564458]}]],[[{"lng":[-1.18035914920938,-1.3023447729013],"lat":[50.6441760538615,50.7026730223134]}]],[[{"lng":[-1.18035914920938,-1.09659838923648],"lat":[50.6441760538615,50.694244497424]}]],[[{"lng":[-1.18035914920938,-1.30109588996732],"lat":[50.6441760538615,50.694111412435]}]],[[{"lng":[-1.18035914920938,-1.52635769238148],"lat":[50.6441760538615,50.6839661914116]}]],[[{"lng":[-1.18035914920938,-1.38653729071091],"lat":[50.6441760538615,50.6816556263349]}]],[[{"lng":[-1.18035914920938,-1.15498622859574],"lat":[50.6441760538615,50.6593991947347]}]],[[{"lng":[-1.18035914920938,-1.18035914920938],"lat":[50.6441760538615,50.6441760538615]}]],[[{"lng":[-1.18035914920938,-1.17583190156454],"lat":[50.6441760538615,50.634468081491]}]],[[{"lng":[-1.18035914920938,-1.28375913686034],"lat":[50.6441760538615,50.6156869113117]}]],[[{"lng":[-1.18035914920938,-1.21080959854917],"lat":[50.6441760538615,50.5978105158296]}]],[[{"lng":[-1.17583190156454,-1.29751408324623],"lat":[50.634468081491,50.7571421447456]}]],[[{"lng":[-1.17583190156454,-1.31006711916123],"lat":[50.634468081491,50.7534038592352]}]],[[{"lng":[-1.17583190156454,-1.28149160450734],"lat":[50.634468081491,50.751845127431]}]],[[{"lng":[-1.17583190156454,-1.15850885830822],"lat":[50.634468081491,50.7287388002202]}]],[[{"lng":[-1.17583190156454,-1.22406933736016],"lat":[50.634468081491,50.726134669078]}]],[[{"lng":[-1.17583190156454,-1.1738784568452],"lat":[50.634468081491,50.723010861409]}]],[[{"lng":[-1.17583190156454,-1.15588435552669],"lat":[50.634468081491,50.7218561008228]}]],[[{"lng":[-1.17583190156454,-1.28428479295049],"lat":[50.634468081491,50.7032568564458]}]],[[{"lng":[-1.17583190156454,-1.3023447729013],"lat":[50.634468081491,50.7026730223134]}]],[[{"lng":[-1.17583190156454,-1.09659838923648],"lat":[50.634468081491,50.694244497424]}]],[[{"lng":[-1.17583190156454,-1.30109588996732],"lat":[50.634468081491,50.694111412435]}]],[[{"lng":[-1.17583190156454,-1.52635769238148],"lat":[50.634468081491,50.6839661914116]}]],[[{"lng":[-1.17583190156454,-1.38653729071091],"lat":[50.634468081491,50.6816556263349]}]],[[{"lng":[-1.17583190156454,-1.15498622859574],"lat":[50.634468081491,50.6593991947347]}]],[[{"lng":[-1.17583190156454,-1.18035914920938],"lat":[50.634468081491,50.6441760538615]}]],[[{"lng":[-1.17583190156454,-1.17583190156454],"lat":[50.634468081491,50.634468081491]}]],[[{"lng":[-1.17583190156454,-1.28375913686034],"lat":[50.634468081491,50.6156869113117]}]],[[{"lng":[-1.17583190156454,-1.21080959854917],"lat":[50.634468081491,50.5978105158296]}]],[[{"lng":[-1.28375913686034,-1.29751408324623],"lat":[50.6156869113117,50.7571421447456]}]],[[{"lng":[-1.28375913686034,-1.31006711916123],"lat":[50.6156869113117,50.7534038592352]}]],[[{"lng":[-1.28375913686034,-1.28149160450734],"lat":[50.6156869113117,50.751845127431]}]],[[{"lng":[-1.28375913686034,-1.15850885830822],"lat":[50.6156869113117,50.7287388002202]}]],[[{"lng":[-1.28375913686034,-1.22406933736016],"lat":[50.6156869113117,50.726134669078]}]],[[{"lng":[-1.28375913686034,-1.1738784568452],"lat":[50.6156869113117,50.723010861409]}]],[[{"lng":[-1.28375913686034,-1.15588435552669],"lat":[50.6156869113117,50.7218561008228]}]],[[{"lng":[-1.28375913686034,-1.28428479295049],"lat":[50.6156869113117,50.7032568564458]}]],[[{"lng":[-1.28375913686034,-1.3023447729013],"lat":[50.6156869113117,50.7026730223134]}]],[[{"lng":[-1.28375913686034,-1.09659838923648],"lat":[50.6156869113117,50.694244497424]}]],[[{"lng":[-1.28375913686034,-1.30109588996732],"lat":[50.6156869113117,50.694111412435]}]],[[{"lng":[-1.28375913686034,-1.52635769238148],"lat":[50.6156869113117,50.6839661914116]}]],[[{"lng":[-1.28375913686034,-1.38653729071091],"lat":[50.6156869113117,50.6816556263349]}]],[[{"lng":[-1.28375913686034,-1.15498622859574],"lat":[50.6156869113117,50.6593991947347]}]],[[{"lng":[-1.28375913686034,-1.18035914920938],"lat":[50.6156869113117,50.6441760538615]}]],[[{"lng":[-1.28375913686034,-1.17583190156454],"lat":[50.6156869113117,50.634468081491]}]],[[{"lng":[-1.28375913686034,-1.28375913686034],"lat":[50.6156869113117,50.6156869113117]}]],[[{"lng":[-1.28375913686034,-1.21080959854917],"lat":[50.6156869113117,50.5978105158296]}]],[[{"lng":[-1.21080959854917,-1.29751408324623],"lat":[50.5978105158296,50.7571421447456]}]],[[{"lng":[-1.21080959854917,-1.31006711916123],"lat":[50.5978105158296,50.7534038592352]}]],[[{"lng":[-1.21080959854917,-1.28149160450734],"lat":[50.5978105158296,50.751845127431]}]],[[{"lng":[-1.21080959854917,-1.15850885830822],"lat":[50.5978105158296,50.7287388002202]}]],[[{"lng":[-1.21080959854917,-1.22406933736016],"lat":[50.5978105158296,50.726134669078]}]],[[{"lng":[-1.21080959854917,-1.1738784568452],"lat":[50.5978105158296,50.723010861409]}]],[[{"lng":[-1.21080959854917,-1.15588435552669],"lat":[50.5978105158296,50.7218561008228]}]],[[{"lng":[-1.21080959854917,-1.28428479295049],"lat":[50.5978105158296,50.7032568564458]}]],[[{"lng":[-1.21080959854917,-1.3023447729013],"lat":[50.5978105158296,50.7026730223134]}]],[[{"lng":[-1.21080959854917,-1.09659838923648],"lat":[50.5978105158296,50.694244497424]}]],[[{"lng":[-1.21080959854917,-1.30109588996732],"lat":[50.5978105158296,50.694111412435]}]],[[{"lng":[-1.21080959854917,-1.52635769238148],"lat":[50.5978105158296,50.6839661914116]}]],[[{"lng":[-1.21080959854917,-1.38653729071091],"lat":[50.5978105158296,50.6816556263349]}]],[[{"lng":[-1.21080959854917,-1.15498622859574],"lat":[50.5978105158296,50.6593991947347]}]],[[{"lng":[-1.21080959854917,-1.18035914920938],"lat":[50.5978105158296,50.6441760538615]}]],[[{"lng":[-1.21080959854917,-1.17583190156454],"lat":[50.5978105158296,50.634468081491]}]],[[{"lng":[-1.21080959854917,-1.28375913686034],"lat":[50.5978105158296,50.6156869113117]}]],[[{"lng":[-1.21080959854917,-1.21080959854917],"lat":[50.5978105158296,50.5978105158296]}]]],null,null,{"interactive":true,"className":"","stroke":true,"color":"#03F","weight":5,"opacity":0.5,"fill":false,"fillColor":"#03F","fillOpacity":0.2,"smoothFactor":1,"noClip":false},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[50.5978105158296,50.7571421447456],"lng":[-1.52635769238148,-1.09659838923648]}},"evals":[],"jsHooks":[]}</script><p>The previous code chunk downloads and processes 306 origin-destination pairs, representing inter-zonal commuting trips made by 42,139 people on the island (population: <a href="https://en.wikipedia.org/wiki/Isle_of_Wight">140,000</a>, the function omits intra-zonal flows). We can verify this as follows:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(wight_od)</a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="co">#&gt; [1] 324</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(wight_od<span class="op">$</span>all)</a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt; [1] 42139</span></a></code></pre></div>
<p>The next step is to convert these straight desire lines into routes that can be cycled, e.g. as follows:</p>
<p>To estimate cycling levels under the UK government target for the Isle of Wight, you would first get the desire lines (the code below gets all the lines, not run because you need an API key from CycleStreets.net and it takes some time):</p>
</div>
<div id="estimate-cycling-uptake" class="section level2">
<h2 class="hasAnchor">
<a href="#estimate-cycling-uptake" class="anchor"></a>Estimate cycling uptake</h2>
<p>Functions named with <code>uptake_*()</code> estimate cycling uptake:</p>
<ul>
<li>
<code><a href="../reference/uptake_pct_godutch.html">uptake_pct_godutch()</a></code>: generates the “GoDutch” scenario level of cycling based on a particular route’s hilliness percentage and length.</li>
<li>
<code><a href="../reference/uptake_pct_govtarget.html">uptake_pct_govtarget()</a></code>: generates the UK government target again based on the hilliness and length parameters.</li>
</ul>
<p>Step two: we generate a fast route network using <code>stplanr</code>, we would need a CycleStreets.Net API key for this:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">wight_routes_fast =<span class="st"> </span>stplanr<span class="op">::</span><span class="kw"><a href="https://ropensci.github.io/stplanr/reference/line2route.html">line2route</a></span>(<span class="dt">l =</span> wight_lines_<span class="dv">30</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/sf/topics/plot">plot</a></span>(wight_routes_fast[, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"av_incline"</span>)])</a></code></pre></div>
<p>Step three: we can now get the propensity to cycle percentages from the <code>uptake_pct_godutch</code> using the <code>length</code> and <code>av_incline</code> from the <code>wight_routes_fast</code> object.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">wight_pcycle_dutch =<span class="st"> </span>pct<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/pct/topics/uptake_pct_godutch">uptake_pct_godutch</a></span>(</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">  <span class="dt">distance =</span> wight_routes_fast<span class="op">$</span>length,</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">  <span class="dt">gradient =</span> wight_routes_fast<span class="op">$</span>av_incline</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">)</a>
<a class="sourceLine" id="cb15-5" data-line-number="5"></a>
<a class="sourceLine" id="cb15-6" data-line-number="6">wight_psycle_gov =<span class="st"> </span>pct<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/pct/topics/uptake_pct_govtarget">uptake_pct_govtarget</a></span>(</a>
<a class="sourceLine" id="cb15-7" data-line-number="7">  <span class="dt">distance =</span> wight_routes_fast<span class="op">$</span>length,</a>
<a class="sourceLine" id="cb15-8" data-line-number="8">  <span class="dt">gradient =</span> wight_routes_fast<span class="op">$</span>av_incline</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">  </a>
<a class="sourceLine" id="cb15-11" data-line-number="11">wight_uptake =<span class="st"> </span>wight_routes_fast</a>
<a class="sourceLine" id="cb15-12" data-line-number="12">wight_uptake<span class="op">$</span>govtarget =<span class="st"> </span>wight_psycle_gov</a>
<a class="sourceLine" id="cb15-13" data-line-number="13">wight_uptake<span class="op">$</span>godutch =<span class="st"> </span>wight_pcycle_dutch</a>
<a class="sourceLine" id="cb15-14" data-line-number="14"></a>
<a class="sourceLine" id="cb15-15" data-line-number="15"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb15-16" data-line-number="16"><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(wight_uptake) <span class="op">+</span></a>
<a class="sourceLine" id="cb15-17" data-line-number="17"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(</a>
<a class="sourceLine" id="cb15-18" data-line-number="18">    length,</a>
<a class="sourceLine" id="cb15-19" data-line-number="19">    govtarget,</a>
<a class="sourceLine" id="cb15-20" data-line-number="20">    <span class="dt">colour =</span> <span class="st">"govtarget"</span></a>
<a class="sourceLine" id="cb15-21" data-line-number="21">  )) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-22" data-line-number="22"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_line</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(</a>
<a class="sourceLine" id="cb15-23" data-line-number="23">    length,</a>
<a class="sourceLine" id="cb15-24" data-line-number="24">    godutch,</a>
<a class="sourceLine" id="cb15-25" data-line-number="25">    <span class="dt">colour =</span> <span class="st">"godutch"</span></a>
<a class="sourceLine" id="cb15-26" data-line-number="26">  ))</a></code></pre></div>
<p>We can also see which routes would have the highest uptake using mapping packages such as:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># mapview::mapview(wight_uptake, zcol = "govtarget")</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="co"># mapview::mapview(wight_uptake, zcol = "godutch")</span></a></code></pre></div>
<p><img src="https://user-images.githubusercontent.com/408568/54354252-0f52f880-464e-11e9-893b-dab3ef8bae4d.png"><!-- --></p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-lovelace_propensity_2017">
<p>Lovelace, Robin, Anna Goodman, Rachel Aldred, Nikolai Berkoff, Ali Abbas, and James Woodcock. 2017. “The Propensity to Cycle Tool: An Open Source Online System for Sustainable Transport Planning.” <em>Journal of Transport and Land Use</em> 10 (1). <a href="https://doi.org/10.5198/jtlu.2016.862" class="uri">https://doi.org/10.5198/jtlu.2016.862</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#why-this-package">Why this package?</a></li>
      <li><a href="#installation">Installation</a></li>
      <li><a href="#get-pct-data">Get PCT data</a></li>
      <li>
<a href="#comparing-downloaded-data-with-the-pct-web-app">Comparing downloaded data with the PCT web app</a><ul class="nav nav-pills nav-stacked">
<li><a href="#getting-census-data">Getting Census data</a></li>
      <li><a href="#estimate-cycling-uptake">Estimate cycling uptake</a></li>
      </ul>
</li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Robin Lovelace, Layik Hama.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
